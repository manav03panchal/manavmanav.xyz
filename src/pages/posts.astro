---
import { getCollection } from 'astro:content';
import BaseLayout from '../layouts/BaseLayout.astro';

const posts = (await getCollection('blog')).sort(
  (a, b) => new Date(b.data.date).valueOf() - new Date(a.data.date).valueOf()
);
---

<BaseLayout>
  <div class="min-h-screen bg-primary">
    <div class="px-6 lg:px-8 2xl:max-w-7xl mx-auto py-8">
      <!-- Header -->
      <header class="mb-8" data-aos="fade-up" data-aos-duration="600">
        <div class="flex justify-between items-center mb-6">
          <a href="/" class="text-secondary/60 text-sm hover:text-secondary transition-colors">
            ‚Üê Back
          </a>
          <button id="theme-toggle" class="hover:text-secondary/60 text-secondary transition-colors text-xs" aria-label="Toggle dark mode">
            <span class="dark-icon hidden">Light</span>
            <span class="light-icon">Dark</span>
          </button>
        </div>
        
        <div class="space-y-2">
          <div class="h-0.5 bg-secondary" data-aos="fade-up" data-aos-duration="800"></div>
          <h1 class="text-secondary text-base font-medium" data-aos="fade-up" data-aos-duration="800">
            <span>Writing</span>
            <span class="font-bold">Archive</span>
          </h1>
        </div>
      </header>

      <!-- Posts Grid -->
      <ul class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6" role="list">
        {posts.map((post, index) => (
          <li data-aos="fade-up" data-aos-duration="800" data-aos-delay={index * 100}>
            <a href={`/blog/${post.slug}`} class="group block">
              <div>
                <p class="text-xs text-secondary/50">
                  {new Date(post.data.date).toISOString().split('T')[0]}
                </p>
                <h2 class="text-lg font-medium text-secondary group-hover:text-secondary/70 transition-colors mt-1">
                  {post.data.title}
                </h2>
                {post.data.description && (
                  <p class="text-sm text-secondary/60 mt-2 line-clamp-2">
                    {post.data.description}
                  </p>
                )}
              </div>
            </a>
          </li>
        ))}
      </ul>
    </div>
  </div>
</BaseLayout>
